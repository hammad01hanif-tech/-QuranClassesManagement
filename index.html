<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <title>Quran Classes โ ูุธุงู ุฅุฏุงุฑุฉ ุงูุญููุงุช</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  
  <!-- Role Selection Page -->
  <div id="roleSelection" class="role-selection">
    <h1>ูุธุงู ุฅุฏุงุฑุฉ ุญููุงุช ุงููุฑุขู ุงููุฑูู</h1>
    <p style="margin-bottom: 30px;">ุงุฎุชุฑ ุฏูุฑู ููุฏุฎูู ุฅูู ุงููุธุงู</p>
    <button class="role-button" onclick="window.selectRole('admin')">
      ๐จโ๐ผ<br>ูุฏูุฑ<br>Admin
    </button>
    <button class="role-button" onclick="window.selectRole('teacher')">
      ๐จโ๐ซ<br>ูุนูู<br>Teacher
    </button>
    <button class="role-button" onclick="window.selectRole('student')">
      ๐จโ๐<br>ุทุงูุจ<br>Student
    </button>
    <button class="role-button" onclick="window.selectRole('viewer')">
      ๐<br>ุนุงุฑุถ ุงูุฃุฌุฒุงุก<br>Parts Viewer
    </button>
  </div>

  <!-- Admin Section -->
  <div id="adminSection" class="admin-section" style="display:none;">
    <div class="admin-header">
      <h2>ููุญุฉ ุชุญูู ุงููุฏูุฑ</h2>
      <div class="date-time-display" id="adminDateTime"></div>
      <div style="position: relative; display: inline-block; margin-left: 15px;">
        <button onclick="window.toggleAdminNotifications()" style="background: #17a2b8; color: white; border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer; font-size: 18px; position: relative;">
          ๐
          <span id="adminNotificationBadge" style="display: none; position: absolute; top: -5px; right: -5px; background: #dc3545; color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; line-height: 20px; text-align: center;">0</span>
        </button>
        <div id="adminNotificationsPanel" style="display: none; position: absolute; top: 50px; left: 0; background: white; border: 2px solid #17a2b8; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.15); width: 400px; max-height: 500px; overflow-y: auto; z-index: 1000;">
          <div style="background: #17a2b8; color: white; padding: 15px; border-radius: 10px 10px 0 0; display: flex; justify-content: space-between; align-items: center;">
            <h3 style="margin: 0; font-size: 16px;">๐ ุงูุฅุดุนุงุฑุงุช</h3>
            <button onclick="window.markAllAdminNotificationsAsRead()" style="background: rgba(255,255,255,0.2); color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 12px;">ุชุนููู ุงููู ูููุฑูุก</button>
          </div>
          <div id="adminNotificationsList" style="padding: 10px;">
            <p style="text-align: center; color: #999; padding: 20px;">ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช</p>
          </div>
        </div>
      </div>
      <button class="logout-btn" onclick="logout()">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
    </div>

    <div class="tabs">
      <button class="tab active" onclick="switchTab('students')">ุฅุฏุงุฑุฉ ุงูุทูุงุจ</button>
      <button class="tab" onclick="switchTab('reports')">ุชูุงุฑูุฑ ุงููุชุงุจุนุฉ</button>
      <button class="tab" onclick="switchTab('struggling')">ุงูุทูุงุจ ุงููุชุนุซุฑูู</button>
      <button class="tab" onclick="switchTab('attendance')">ุชูุงุฑูุฑ ุงูุบูุงุจ</button>
      <button class="tab" onclick="switchTab('classes')">ุฅุฏุงุฑุฉ ุงูุญููุงุช</button>
    </div>

    <!-- Students Management Tab -->
    <div id="studentsTab" class="tab-content active">
      <h3 style="text-align: center; margin-bottom: 30px; color: #667eea; font-size: 24px;">
        ๐ฅ ุฅุฏุงุฑุฉ ุงูุทูุงุจ
      </h3>

      <!-- Add New Student Form -->
      <div class="add-student-form" style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); margin-bottom: 40px;">
        <h4 style="color: #333; margin-bottom: 25px; font-size: 20px; display: flex; align-items: center; gap: 10px;">
          <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px;">โ</span>
          ุฅุถุงูุฉ ุทุงูุจ ุฌุฏูุฏ
        </h4>

        <div class="form-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
          <!-- Student Name -->
          <div class="form-field">
            <label style="display: block; margin-bottom: 8px; color: #555; font-weight: bold; font-size: 14px;">
              <span style="color: #ff6b6b;">*</span> ุงุณู ุงูุทุงูุจ
            </label>
            <input type="text" id="studentName" placeholder="ุฃุฏุฎู ุงูุงุณู ุงููุงูู" required
              style="width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 15px; transition: all 0.3s; font-family: inherit;">
          </div>

          <!-- Birth Date -->
          <div class="form-field">
            <label style="display: block; margin-bottom: 8px; color: #555; font-weight: bold; font-size: 14px;">
              <span style="color: #ff6b6b;">*</span> ุชุงุฑูุฎ ุงููููุงุฏ (ูููุงุฏู)
            </label>
            <input type="date" id="studentBirthDate" required
              style="width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 15px; transition: all 0.3s; font-family: inherit;">
          </div>

          <!-- National ID -->
          <div class="form-field">
            <label style="display: block; margin-bottom: 8px; color: #555; font-weight: bold; font-size: 14px;">
              ุฑูู ุงููููุฉ (ุงุฎุชูุงุฑู)
            </label>
            <input type="text" id="studentNationalId" placeholder="ุฃุฏุฎู ุฑูู ุงููููุฉ"
              style="width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 15px; transition: all 0.3s; font-family: inherit;">
          </div>

          <!-- Student Phone -->
          <div class="form-field">
            <label style="display: block; margin-bottom: 8px; color: #555; font-weight: bold; font-size: 14px;">
              ุฑูู ุฌูุงู ุงูุทุงูุจ (ุงุฎุชูุงุฑู)
            </label>
            <input type="tel" id="studentPhone" placeholder="05xxxxxxxx" pattern="[0-9]{10}"
              style="width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 15px; transition: all 0.3s; font-family: inherit;">
          </div>

          <!-- Guardian Phone -->
          <div class="form-field">
            <label style="display: block; margin-bottom: 8px; color: #555; font-weight: bold; font-size: 14px;">
              <span style="color: #ff6b6b;">*</span> ุฑูู ุฌูุงู ููู ุงูุฃูุฑ
            </label>
            <input type="tel" id="guardianPhone" placeholder="05xxxxxxxx" pattern="[0-9]{10}" required
              style="width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 15px; transition: all 0.3s; font-family: inherit;">
          </div>

          <!-- Student Level -->
          <div class="form-field">
            <label style="display: block; margin-bottom: 8px; color: #555; font-weight: bold; font-size: 14px;">
              <span style="color: #ff6b6b;">*</span> ุงููุณุชูู
            </label>
            <select id="studentLevel" required
              style="width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 15px; transition: all 0.3s; font-family: inherit; background: white;">
              <option value="">-- ุงุฎุชุฑ ุงููุณุชูู --</option>
              <option value="hifz">๐ ุญูุธ</option>
              <option value="dabt">โจ ุถุจุท</option>
              <option value="noorani">๐ ุงููุงุนุฏุฉ ุงูููุฑุงููุฉ</option>
            </select>
          </div>

          <!-- Class Selection -->
          <div class="form-field">
            <label style="display: block; margin-bottom: 8px; color: #555; font-weight: bold; font-size: 14px;">
              <span style="color: #ff6b6b;">*</span> ุงุณู ุงูุญููุฉ
            </label>
            <select id="classSelectAdd" required
              style="width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 15px; transition: all 0.3s; font-family: inherit; background: white;">
              <option value="">-- ุงุฎุชุฑ ุงูุญููุฉ --</option>
            </select>
          </div>
        </div>

        <!-- Submit Button -->
        <div style="margin-top: 30px; text-align: center;">
          <button onclick="addStudent()" 
            style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px 50px; border: none; border-radius: 10px; font-size: 16px; font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(102,126,234,0.4); transition: all 0.3s; font-family: inherit;">
            โ ุฅุถุงูุฉ ุงูุทุงูุจ
          </button>
        </div>
        
        <p id="result" style="margin-top: 20px; text-align: center; font-size: 15px; font-weight: bold;"></p>
      </div>

      <hr style="border: none; border-top: 2px solid #e0e0e0; margin: 40px 0;">

      <h3 style="text-align: center; margin-bottom: 25px; color: #667eea; font-size: 20px;">
        ๐ ูุงุฆูุฉ ุงูุทูุงุจ ุญุณุจ ุงูุญููุฉ
      </h3>
      
      <div style="background: white; padding: 20px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1);">
        <label style="display: block; margin-bottom: 10px; color: #555; font-weight: bold; font-size: 15px;">ุงุฎุชูุงุฑ ุงูุญููุฉ:</label>
        <select id="classSelectView" 
          style="width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 15px; font-family: inherit; background: white;">
          <option value="">-- ุงุฎุชุฑ ุงูุญููุฉ --</option>
        </select>

        <div id="students" class="student-list" style="margin-top: 20px;">ุงุฎุชุฑ ุญููุฉ ูุนุฑุถ ุงูุทูุงุจ</div>
      </div>
    </div>

    <!-- Reports Tab -->
    <div id="reportsTab" class="tab-content">
      <h3>ุชูุงุฑูุฑ ูุชุงุจุนุฉ ุงูุทูุงุจ</h3>
      
      <label>ุงุฎุชุฑ ุงูุญููุฉ:</label>
      <select id="classSelectReports"><option value="">-- ุงุฎุชุฑ ุงูุญููุฉ --</option></select>
      
      <label>ุงุฎุชุฑ ุงูุทุงูุจ:</label>
      <select id="studentSelectReports"><option value="">-- ุงุฎุชุฑ ุทุงูุจ --</option></select>
      
      <!-- Statistics Summary -->
      <div id="studentStatsSummary" style="display:none; margin-top: 20px;">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px;">
          <!-- Weekly Stats Card -->
          <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 12px; color: white; box-shadow: 0 5px 15px rgba(102,126,234,0.3);">
            <h4 style="margin: 0 0 15px 0; font-size: 16px;">๐ ุงูุญุตุงุฏ ุงูุฃุณุจูุนู</h4>
            <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 8px; margin-bottom: 10px;">
              <p style="margin: 0; font-size: 14px;">๐ ุงูุฏุฑูุณ ุงูููุฌุฒุฉ</p>
              <p style="margin: 5px 0 0 0; font-size: 28px; font-weight: bold;" id="weeklyLessonsCount">0</p>
            </div>
            <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 8px;">
              <p style="margin: 0; font-size: 14px;">๐ ุตูุญุงุช ุงููุฑุงุฌุนุฉ</p>
              <p style="margin: 5px 0 0 0; font-size: 28px; font-weight: bold;" id="weeklyRevisionPages">0</p>
            </div>
          </div>
          
          <!-- Monthly Stats Card -->
          <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 20px; border-radius: 12px; color: white; box-shadow: 0 5px 15px rgba(245,87,108,0.3);">
            <h4 style="margin: 0 0 15px 0; font-size: 16px;">๐ ุงูุญุตุงุฏ ุงูุดูุฑู</h4>
            <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 8px; margin-bottom: 10px;">
              <p style="margin: 0; font-size: 14px;">๐ ุงูุฏุฑูุณ ุงูููุฌุฒุฉ</p>
              <p style="margin: 5px 0 0 0; font-size: 28px; font-weight: bold;" id="monthlyLessonsCount">0</p>
            </div>
            <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 8px;">
              <p style="margin: 0; font-size: 14px;">๐ ุตูุญุงุช ุงููุฑุงุฌุนุฉ</p>
              <p style="margin: 5px 0 0 0; font-size: 28px; font-weight: bold;" id="monthlyRevisionPages">0</p>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Month and Day Filters -->
      <div id="adminReportsFilters" style="display: none; margin: 20px 0;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 15px; border-radius: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; align-items: end;">
          <div>
            <label style="display: block; color: white; font-weight: bold; margin-bottom: 8px; font-size: 14px;">๐ ุงูุดูุฑ ุงููุฌุฑู:</label>
            <select id="adminReportsMonthFilter" onchange="window.populateAdminReportsDaysFilter()" style="width: 100%; padding: 10px; border-radius: 8px; border: 2px solid white; font-size: 14px; font-weight: bold;">
              <option value="">-- ุงุฎุชุฑ ุงูุดูุฑ --</option>
            </select>
          </div>
          <div>
            <label style="display: block; color: white; font-weight: bold; margin-bottom: 8px; font-size: 14px;">๐ ุงูููู:</label>
            <select id="adminReportsDateFilter" onchange="window.filterAdminReportsByDate()" style="width: 100%; padding: 10px; border-radius: 8px; border: 2px solid white; font-size: 14px; font-weight: bold;">
              <option value="all-days">ุฌููุน ุฃูุงู ุงูุดูุฑ</option>
            </select>
          </div>
        </div>
      </div>
      
      <div id="reportsContainer" style="margin-top: 20px;">
        <p class="small">ุงุฎุชุฑ ุญููุฉ ูุทุงูุจ ูุนุฑุถ ุชูุงุฑูุฑ ุงููุชุงุจุนุฉ</p>
      </div>
    </div>

    <!-- Classes Management Tab -->
    <div id="classesTab" class="tab-content">
      <h3>ุฅุฏุงุฑุฉ ุงูุญููุงุช</h3>
      <p class="small">ูุฑูุจุงู: ุฅุถุงูุฉ ูุชุนุฏูู ุงูุญููุงุช</p>
    </div>

    <!-- Struggling Students Tab -->
    <div id="strugglingTab" class="tab-content">
      <h3>๐ ุชูุงุฑูุฑ ุงูุทูุงุจ ุงููุชุนุซุฑูู</h3>
      
      <label>ุงุฎุชุฑ ุงูุญููุฉ:</label>
      <select id="classSelectStruggling" onchange="window.loadStrugglingReports()">
        <option value="">-- ุงุฎุชุฑ ุงูุญููุฉ --</option>
      </select>
      
      <div id="strugglingReportsContainer" style="margin-top: 20px;">
        <p class="small">ุงุฎุชุฑ ุญููุฉ ูุนุฑุถ ุชูุงุฑูุฑ ุงูุทูุงุจ ุงููุชุนุซุฑูู</p>
      </div>
    </div>

    <!-- Attendance Reports Tab -->
    <div id="attendanceTab" class="tab-content">
      <h3>๐ ุชูุงุฑูุฑ ุงูุญุถูุฑ ูุงูุบูุงุจ</h3>
      
      <div style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); padding: 20px; border-radius: 12px; color: white; margin: 20px 0;">
        <h4 style="margin: 0 0 15px 0;">ุงุฎุชุฑ ุงูุญููุฉ ูุนุฑุถ ุชูุฑูุฑ ุงูุญุถูุฑ</h4>
        <select id="classSelectAttendance" onchange="window.loadAdminAttendanceReport()" style="width: 100%; max-width: 400px; padding: 12px; border: none; border-radius: 8px; font-size: 16px;">
          <option value="">-- ุงุฎุชุฑ ุงูุญููุฉ --</option>
        </select>
      </div>
      
      <div id="adminAttendanceReportSection" style="display:none; margin-top: 20px;">
        <!-- Filter Section -->
        <div style="background: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 15px;">
          <h3 style="margin: 0 0 15px 0; color: #17a2b8; font-size: 18px;">๐ ููุชุฑุฉ ุชูุงุฑูุฑ ุงูุบูุงุจ</h3>
          
          <!-- Month Filter -->
          <div style="margin-bottom: 12px;">
            <label style="display: block; margin-bottom: 6px; font-weight: bold; color: #666; font-size: 14px;">๐ ุงุฎุชุฑ ุงูุดูุฑ</label>
            <select id="adminAbsenceMonthFilter" onchange="populateAdminDaysFilter()" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
              <option value="">ุฌุงุฑู ุงูุชุญููู...</option>
            </select>
          </div>
          
          <!-- Day Filter -->
          <div style="margin-bottom: 12px;">
            <label style="display: block; margin-bottom: 6px; font-weight: bold; color: #666; font-size: 14px;">๐ ุงุฎุชุฑ ุงูููู</label>
            <select id="adminAbsenceDateFilter" onchange="filterAdminAbsenceReport()" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
              <option value="all-days">ุฌููุน ุฃูุงู ุงูุดูุฑ</option>
            </select>
          </div>
          
          <!-- Teacher Name & Student Count -->
          <div>
            <label style="display: block; margin-bottom: 6px; font-weight: bold; color: #666; font-size: 14px;">๐จโ๐ซ ุงููุนูู</label>
            <div id="adminAttendanceTeacherName" style="padding: 10px; background: #f8f9fa; border-radius: 8px; font-weight: bold; color: #333; font-size: 13px;">-</div>
          </div>
        </div>

        <!-- Statistics Cards -->
        <div id="absenceStatsContainer" style="display: none; margin-bottom: 15px;">
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;">
            <div style="text-align: center; padding: 15px; background: linear-gradient(135deg, #51cf66 0%, #2d7a44 100%); border-radius: 10px; color: white; box-shadow: 0 3px 10px rgba(0,0,0,0.15);">
              <div style="font-size: 12px; opacity: 0.9; margin-bottom: 5px;">โ ุฅุฌูุงูู ุงูุญุถูุฑ</div>
              <div id="totalPresentCount" style="font-size: 28px; font-weight: bold;">0</div>
            </div>
            <div style="text-align: center; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; color: white; box-shadow: 0 3px 10px rgba(0,0,0,0.15);">
              <div style="font-size: 12px; opacity: 0.9; margin-bottom: 5px;">๐ ุบูุงุจ ุจุนุฐุฑ</div>
              <div id="totalWithExcuseCount" style="font-size: 28px; font-weight: bold;">0</div>
            </div>
            <div style="text-align: center; padding: 15px; background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%); border-radius: 10px; color: white; box-shadow: 0 3px 10px rgba(0,0,0,0.15);">
              <div style="font-size: 12px; opacity: 0.9; margin-bottom: 5px;">โ๏ธ ุบูุงุจ ุจุฏูู ุนุฐุฑ</div>
              <div id="totalWithoutExcuseCount" style="font-size: 28px; font-weight: bold;">0</div>
            </div>
          </div>
        </div>

        <!-- Compact 3-column Table -->
        <div style="background: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
          <h3 style="margin: 0 0 12px 0; color: #17a2b8; font-size: 16px;">๐ ูุงุฆูุฉ ุงูุทูุงุจ ุงูุบุงุฆุจูู</h3>
          <table class="compact-absence-table" style="width: 100%; border-collapse: collapse;">
            <thead>
              <tr style="background: #17a2b8; color: white;">
                <th style="padding: 10px; text-align: right; border: 1px solid #ddd; font-size: 14px;">ุงุณู ุงูุทุงูุจ</th>
                <th style="padding: 10px; text-align: center; border: 1px solid #ddd; font-size: 14px; width: 80px;">๐ ุจุนุฐุฑ</th>
                <th style="padding: 10px; text-align: center; border: 1px solid #ddd; font-size: 14px; width: 80px;">โ๏ธ ุจุฏูู ุนุฐุฑ</th>
              </tr>
            </thead>
            <tbody id="adminAttendanceTableBody">
              <tr>
                <td colspan="3" style="text-align: center; padding: 20px; color: #999;">ุงุฎุชุฑ ุญููุฉ ูุนุฑุถ ุงูุชูุฑูุฑ</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Teacher Section -->
  <div id="teacherSection" style="display:none;">
    <!-- Teacher Login -->
    <div id="teacherLogin" class="login-container">
      <h2>ุชุณุฌูู ุฏุฎูู ุงููุนูู</h2>
      <div class="login-form-group">
        <label>ุงุฎุชุฑ ุงููุนูู</label>
        <select id="teacherIdSelect" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
          <option value="">-- ุงุฎุชุฑ ุงููุนูู --</option>
          <option value="ABD01">ABD01 -ุงูุฃุณุชุงุฐ ุนุจุฏุงูุฑุญูู ุงูุณูุณู</option>
          <option value="AMR01">AMR01 -ุงูุฃุณุชุงุฐ ุนุงูุฑ ููุณุงูู</option>
          <option value="ANS01">ANS01 - ุงูุฃุณุชุงุฐ ุฃูุณ</option>
          <option value="HRT01">HRT01 -ุงูุฃุณุชุงุฐ ุญุงุฑุซ</option>
          <option value="JHD01">JHD01 - ุงูุฃุณุชุงุฐ ุฌูุงุฏ</option>
          <option value="JWD01">JWD01 -ุงูุฃุณุชุงุฐ ุนุจุฏุงูุฑุญูู ุฌุงููุฏ</option>
          <option value="MZN01">MZN01 - ุงูุฃุณุชุงุฐ ูุงุฒู</option>
          <option value="NBL01">NBL01 - ุงูุฃุณุชุงุฐ ูุจูู</option>
          <option value="OMR01">OMR01 - ุงูุฃุณุชุงุฐ ุนูุฑ</option>
          <option value="OSM01">OSM01 -ุงูุฃุณุชุงุฐ ุฃุณุงูุฉ ุญุจูุจ</option>
          <option value="SLM01">SLM01 -ุงูุฃุณุชุงุฐ ุณููุงู ุฑููู</option>
        </select>
      </div>
      <div class="login-form-group">
        <label>ุงูุฑูู ุงูุณุฑู (Password)</label>
        <input type="password" id="teacherPasswordInput" placeholder="ุฃุฏุฎู ุงูุฑูู ุงูุณุฑู">
      </div>
      <button class="login-btn" onclick="window.loginTeacher()">ุฏุฎูู</button>
      <div id="loginError" class="login-error"></div>
      <button class="back-btn" onclick="window.showRoleSelection()">ุฑุฌูุน</button>
    </div>

    <!-- Teacher Dashboard (hidden until login) -->
    <div id="teacherDashboard" style="display:none;">
      <div class="admin-header">
        <h2>ููุญุฉ ุชุญูู ุงููุนูู</h2>
        <div class="date-time-display" id="teacherDateTime"></div>
        <button class="logout-btn" onclick="window.logoutTeacher()">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
      </div>

      <div style="padding: 20px;" class="clearfix">
        <div class="teacher-info" style="margin-bottom: 20px; padding: 15px; background: #f0f8ff; border-radius: 10px; position: relative;">
          <!-- One-time cleanup button -->
          <button id="cleanupOldExamsBtn" onclick="window.cleanupOldExams()" style="display: none; position: absolute; right: 15px; top: 50%; transform: translateY(-50%); background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%); color: white; padding: 10px 20px; font-size: 14px; border: none; border-radius: 8px; cursor: pointer; box-shadow: 0 3px 10px rgba(255,107,107,0.4); animation: pulseBtn 2s infinite;">
            ๐๏ธ ุญุฐู ุงูุงุฎุชุจุงุฑุงุช ุงููุฏููุฉ
          </button>
          
          <p style="margin: 0; font-size: 18px; color: #2d7a44;"><strong>ุงูุญููุฉ:</strong> <span id="teacherClassDisplay"></span> - <span id="teacherNameDisplay"></span></p>
        </div>
        
        <!-- Monthly Scores Section -->
        <div id="monthlyScoresSection" style="display: none; float: right; width: 320px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; padding: 15px; margin-left: 20px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
          <h3 style="color: white; margin: 0 0 12px 0; text-align: center; font-size: 17px;">๐ ุงูุฏุฑุฌุงุช ุงูุดูุฑูุฉ</h3>
          
          <!-- All Students Scores -->
          <div id="allScoresDisplay" style="background: rgba(255,255,255,0.95); border-radius: 10px; padding: 12px; max-height: 400px; overflow-y: auto;">
            <div id="allStudentsList"></div>
          </div>
        </div>

        <!-- Struggling Students Section -->
        <div id="strugglingStudentsSection" class="struggling-section" style="display:none; float: right; width: 320px; margin-left: 20px; margin-bottom: 20px;">
          <div class="struggling-header">
            <h3>โ๏ธ ุงูุทูุงุจ ุงููุชุนุซุฑูู ุงูููู</h3>
          </div>
          <div id="strugglingStudentsList" class="struggling-list"></div>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button class="send-to-admin-btn" onclick="window.sendStrugglingToAdmin()" style="display:none;">
              ๐ค ุฅุฑุณุงู ููุฅุฏุงุฑุฉ
            </button>
            <button class="share-struggling-btn" onclick="window.shareStrugglingStudents()" style="display:none; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px;">
              ๐ ูุดุงุฑูุฉ ุงูุจูุงูุงุช
            </button>
          </div>
        </div>

        <!-- Class Attendance Report Section -->
        <div id="classAttendanceReportSection" style="display:none; margin-top: 30px;">
          <div id="classAttendanceTableContainer">
            <div style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); padding: 15px; border-radius: 12px; color: white; margin-bottom: 15px;">
              <h3 style="margin: 0 0 12px 0; font-size: 18px;">๐ ุชูุฑูุฑ ุญุถูุฑ ุฌููุน ุทูุงุจ ุงูุญููุฉ</h3>
              
              <!-- Date Filter -->
              <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 8px; margin-bottom: 12px;">
                <label style="font-size: 13px; opacity: 0.9; margin-bottom: 6px; display: block;">ุงุฎุชุฑ ุงูุชุงุฑูุฎ:</label>
                <select id="attendanceDateFilter" onchange="window.filterAttendanceByDate()" style="width: 100%; padding: 10px; border: 2px solid rgba(255,255,255,0.3); border-radius: 8px; font-size: 14px; background: white; color: #333; cursor: pointer;">
                  <option value="all">ุฌููุน ุฃูุงู ุงูุดูุฑ ุงูุญุงูู</option>
                </select>
              </div>
              
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px;">
                <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px;">
                  <div style="font-size: 12px; opacity: 0.9;">๐จโ๐ซ ุงููุนูู</div>
                  <div id="classAttendanceTeacherName" style="font-size: 14px; font-weight: bold; margin-top: 3px;">-</div>
                </div>
                <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px;">
                  <div style="font-size: 12px; opacity: 0.9;">๐ฅ ุงูุทูุงุจ</div>
                  <div id="classAttendanceTotalStudents" style="font-size: 14px; font-weight: bold; margin-top: 3px;">0</div>
                </div>
                <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px;">
                  <div style="font-size: 12px; opacity: 0.9;">๐ ุงููุชุฑุฉ</div>
                  <div id="classAttendancePeriod" style="font-size: 14px; font-weight: bold; margin-top: 3px;">ุงูุดูุฑ ุงูุญุงูู</div>
                </div>
              </div>
            </div>

            <!-- Compact Student List -->
            <div id="classAttendanceTableBody" style="display: flex; flex-direction: column; gap: 8px; background: white; padding: 15px; border-radius: 12px;">
              <div style="text-align: center; padding: 20px; color: #999;">ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช...</div>
            </div>
          </div>
          
          <div style="text-align: center; margin-top: 20px;">
            <button onclick="hideClassAttendanceReport()" style="background: #6c757d; color: white; padding: 12px 30px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">
              ุฅุบูุงู ุงูุชูุฑูุฑ
            </button>
          </div>
        </div>

        <!-- Monthly Exams Management Section -->
        <div id="monthlyExamsManagementSection" style="display:none; margin-top: 30px;">
          <div style="background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%); padding: 20px; border-radius: 12px 12px 0 0; color: white;">
            <h3 style="margin: 0 0 15px 0;">๐ ุฅุฏุงุฑุฉ ุงูุงุฎุชุจุงุฑุงุช ุงูุดูุฑูุฉ</h3>
            
            <!-- Month Filter -->
            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
              <label style="font-size: 14px; opacity: 0.9; margin-bottom: 8px; display: block;">ุชุตููุฉ ุญุณุจ ุงูุดูุฑ ุงููุฌุฑู:</label>
              <select id="examMonthFilter" onchange="window.filterExamsByMonth()" style="width: 100%; max-width: 300px; padding: 10px; border: 2px solid rgba(255,255,255,0.3); border-radius: 8px; font-size: 16px; background: white; color: #333; cursor: pointer;">
                <option value="all">ุฌููุน ุงูุฃุดูุฑ</option>
              </select>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
              <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 8px;">
                <div style="font-size: 13px; opacity: 0.9;">๐ ุนุฏุฏ ุงูุงุฎุชุจุงุฑุงุช</div>
                <div id="totalExamsCount" style="font-size: 18px; font-weight: bold; margin-top: 5px;">0</div>
              </div>
              <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 8px;">
                <div style="font-size: 13px; opacity: 0.9;">โ ูุงุฌุญ</div>
                <div id="passedExamsCount" style="font-size: 18px; font-weight: bold; margin-top: 5px;">0</div>
              </div>
              <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 8px;">
                <div style="font-size: 13px; opacity: 0.9;">โ ุฑุงุณุจ</div>
                <div id="failedExamsCount" style="font-size: 18px; font-weight: bold; margin-top: 5px;">0</div>
              </div>
            </div>
          </div>

          <div style="overflow-x: auto; background: white; padding: 20px; border-radius: 0 0 12px 12px;">
            <table class="reports-table" style="width: 100%; border-collapse: collapse; min-width: 900px;">
              <thead>
                <tr style="background: #9c27b0; color: white;">
                  <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">#</th>
                  <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">ุงุณู ุงูุทุงูุจ</th>
                  <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ุงูุชุงุฑูุฎ</th>
                  <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ุงูุฏุฑุฌุฉ</th>
                  <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ุงููุณุจุฉ</th>
                  <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ุงููุชูุฌุฉ</th>
                  <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ุงูุฅุฌุฑุงุกุงุช</th>
                </tr>
              </thead>
              <tbody id="monthlyExamsTableBody">
                <tr>
                  <td colspan="7" style="text-align: center; padding: 20px;">ูุง ุชูุฌุฏ ุงุฎุชุจุงุฑุงุช ุดูุฑูุฉ</td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div style="text-align: center; margin-top: 20px;">
            <button onclick="window.hideMonthlyExamsManagement()" style="background: #6c757d; color: white; padding: 12px 30px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">
              ุฅุบูุงู
            </button>
          </div>
        </div>

        <!-- Exam Details Modal -->
        <div id="examDetailsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; justify-content: center; align-items: center;">
          <div style="background: white; width: 90%; max-width: 800px; max-height: 80vh; border-radius: 15px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
            <div style="background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%); color: white; padding: 20px; display: flex; justify-content: space-between; align-items: center;">
              <h3 style="margin: 0; font-size: 22px;">๐ ุชูุงุตูู ุงูุงุฎุชุจุงุฑ ุงูุดูุฑู</h3>
              <button onclick="window.closeExamDetailsModal()" style="background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; cursor: pointer; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">ร</button>
            </div>
            <div id="examDetailsContent" style="padding: 20px; max-height: calc(80vh - 80px); overflow-y: auto;">
              <!-- Exam details will be loaded here -->
            </div>
          </div>
        </div>

        <!-- Main Content Area -->
        <div class="main-content-area">
        
        <!-- Tools Toolbar -->
        <div class="tools-toolbar" style="background: white; padding: 15px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
          <button class="tool-btn" onclick="showTopPerformers()" style="background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%); color: white; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: bold; box-shadow: 0 2px 8px rgba(255,215,0,0.3); transition: all 0.3s;">
            ๐ ุชุฑุชูุจ ุงูุฃูุงุฆู
          </button>
          <button class="tool-btn" onclick="showTodayStrugglingReport()" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: bold; box-shadow: 0 2px 8px rgba(220,53,69,0.3); transition: all 0.3s;">
            โ๏ธ ูุชุนุซุฑู ุงูููู
          </button>
          <button class="tool-btn" onclick="showNotificationsBox()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: bold; box-shadow: 0 2px 8px rgba(102,126,234,0.3); transition: all 0.3s; position: relative;">
            ๐ ุงูุฅุดุนุงุฑุงุช
            <span id="notificationBadge" style="display: none; position: absolute; top: -5px; right: -5px; background: #ff4444; color: white; border-radius: 50%; width: 22px; height: 22px; font-size: 12px; display: flex; align-items: center; justify-content: center; font-weight: bold;">0</span>
          </button>
          <button class="tool-btn" onclick="showClassAttendanceReport()" style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); color: white; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: bold; box-shadow: 0 2px 8px rgba(23,162,184,0.3); transition: all 0.3s;">
            ๐ ุชูุฑูุฑ ุงูุญุถูุฑ
          </button>
          <button class="tool-btn" onclick="showMonthlyExamsReport()" style="background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%); color: white; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: bold; box-shadow: 0 2px 8px rgba(156,39,176,0.3); transition: all 0.3s;">
            ๐ ุชูุฑูุฑ ุงูุงุฎุชุจุงุฑุงุช
          </button>
        </div>

        <!-- Students Grid -->
        <h3 style="color: #2d7a44; margin-bottom: 20px; text-align: center;">๐ฅ ุทูุงุจ ุงูุญููุฉ</h3>
        <div id="studentsGridContainer" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px;">
          <!-- Students will be loaded here dynamically -->
        </div>

      <div id="teacherStudentActions" style="display:none; margin-top: 20px;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 12px; color: white; margin-bottom: 20px; box-shadow: 0 3px 15px rgba(0,0,0,0.2);">
          <h4 style="margin: 0 0 5px 0; font-size: 20px;">๐ค ุงูุทุงูุจ ุงููุฎุชุงุฑ</h4>
          <div style="font-size: 24px; font-weight: bold;"><span id="selectedTeacherStudent"></span></div>
        </div>
        
        <!-- Student Score and Rank Display -->
        <div id="studentScoreDisplay" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 10px; padding: 15px; margin: 15px 0; text-align: center; color: white; box-shadow: 0 3px 10px rgba(0,0,0,0.2);">
          <div style="display: flex; justify-content: center; gap: 30px; align-items: center; flex-wrap: wrap;">
            <div>
              <div style="font-size: 13px; opacity: 0.9;">ุงูุชุฑุชูุจ</div>
              <div id="studentRankValue" style="font-size: 28px; font-weight: bold;">#-</div>
            </div>
            <div style="width: 2px; height: 40px; background: rgba(255,255,255,0.3);"></div>
            <div>
              <div style="font-size: 13px; opacity: 0.9;">ุงูุฏุฑุฌุฉ ุงูุดูุฑูุฉ</div>
              <div id="studentScoreValue" style="font-size: 28px; font-weight: bold;">0</div>
            </div>
          </div>
        </div>

        <!-- Student Attendance Report Section -->
        <div id="attendanceReportSection" style="display:none; margin-top: 30px;">
          <div style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); padding: 20px; border-radius: 12px; color: white; margin-bottom: 20px;">
            <h3 style="margin: 0 0 15px 0;">๐ ุชูุฑูุฑ ุญุถูุฑ ุงูุทุงูุจ</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
              <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 8px;">
                <div style="font-size: 13px; opacity: 0.9;">๐ค ุงูุทุงูุจ</div>
                <div id="studentAttendanceName" style="font-size: 18px; font-weight: bold; margin-top: 5px;">-</div>
              </div>
              <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 8px;">
                <div style="font-size: 13px; opacity: 0.9;">๐ ุงููุชุฑุฉ</div>
                <div id="studentAttendancePeriod" style="font-size: 18px; font-weight: bold; margin-top: 5px;">ุงูุดูุฑ ุงูุญุงูู</div>
              </div>
            </div>
          </div>

          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px;">
            <div style="background: white; padding: 20px; border-radius: 10px; text-align: center; border: 2px solid #28a745;">
              <div style="font-size: 14px; color: #666; margin-bottom: 10px;">โ ุฃูุงู ุงูุญุถูุฑ</div>
              <div id="studentPresentDays" style="font-size: 36px; font-weight: bold; color: #28a745;">0</div>
            </div>
            <div style="background: white; padding: 20px; border-radius: 10px; text-align: center; border: 2px solid #dc3545;">
              <div style="font-size: 14px; color: #666; margin-bottom: 10px;">โ ุฃูุงู ุงูุบูุงุจ</div>
              <div id="studentAbsentDays" style="font-size: 36px; font-weight: bold; color: #dc3545;">0</div>
            </div>
          </div>
        </div>

        <!-- New Assessment Form -->
        <div id="newAssessmentForm" class="assessment-form" style="display:none; margin-top: 30px;">
          <h3>๐ ูููุฐุฌ ุงูุชูููู ุงูุฌุฏูุฏ</h3>

          <!-- Student Status (Present/Absent) -->
          <div class="form-group" style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
            <label style="font-size: 16px; font-weight: bold; color: #856404; margin-bottom: 10px; display: block;">๐ ุญุงูุฉ ุงูุทุงูุจ</label>
            <div style="display: flex; gap: 15px; justify-content: center;">
              <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 20px; background: white; border: 2px solid #28a745; border-radius: 8px;">
                <input type="radio" name="studentStatus" value="present" checked onchange="toggleAbsentMode()">
                <span style="font-size: 16px; color: #28a745; font-weight: bold;">โ ุญุงุถุฑ</span>
              </label>
              <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 20px; background: white; border: 2px solid #dc3545; border-radius: 8px;">
                <input type="radio" name="studentStatus" value="absent" onchange="toggleAbsentMode()">
                <span style="font-size: 16px; color: #dc3545; font-weight: bold;">โ ุบุงุฆุจ</span>
              </label>
            </div>
            
            <!-- Excuse Type (Only shown when absent) -->
            <div id="excuseTypeContainer" style="display: none; margin-top: 15px; padding: 15px; background: #f8d7da; border-radius: 8px; border: 2px solid #dc3545;">
              <label style="font-size: 15px; font-weight: bold; color: #721c24; margin-bottom: 10px; display: block;">๐ ููุน ุงูุบูุงุจ</label>
              <div style="display: flex; gap: 12px; justify-content: center;">
                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 16px; background: white; border: 2px solid #dc3545; border-radius: 8px;">
                  <input type="radio" name="excuseType" value="withExcuse" checked>
                  <span style="font-size: 14px; color: #dc3545; font-weight: bold;">๐ ุจุนุฐุฑ</span>
                </label>
                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 16px; background: white; border: 2px solid #dc3545; border-radius: 8px;">
                  <input type="radio" name="excuseType" value="withoutExcuse">
                  <span style="font-size: 14px; color: #dc3545; font-weight: bold;">โ๏ธ ุจุฏูู ุนุฐุฑ</span>
                </label>
              </div>
            </div>
          </div>

          <!-- Recitation Type (Hifz/Dabt) -->
          <div class="form-group" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; padding: 15px; margin-bottom: 20px;">
            <label style="font-size: 16px; font-weight: bold; color: white; margin-bottom: 10px; display: block;">๐ ููุน ุงูุชุณููุน</label>
            <div style="display: flex; gap: 15px; justify-content: center;">
              <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 12px 24px; background: rgba(255,255,255,0.95); border: 3px solid #667eea; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.15); transition: all 0.3s;">
                <input type="radio" name="recitationType" value="hifz" checked>
                <span style="font-size: 16px; color: #667eea; font-weight: bold;">๐ ุญูุธ (ุนูุณู)</span>
              </label>
              <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 12px 24px; background: rgba(255,255,255,0.95); border: 3px solid #764ba2; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.15); transition: all 0.3s;">
                <input type="radio" name="recitationType" value="dabt">
                <span style="font-size: 16px; color: #764ba2; font-weight: bold;">โจ ุถุจุท (ุชุฑุชูุจู)</span>
              </label>
            </div>
            <div style="margin-top: 12px; padding: 10px; background: rgba(255,255,255,0.2); border-radius: 8px; text-align: center;">
              <small style="color: white; font-size: 13px; line-height: 1.6;">
                ๐ก <strong>ุญูุธ:</strong> ูู ุงููุงุณ โ ุงูุจูุฑุฉ (ุนูุณู) | <strong>ุถุจุท:</strong> ูู ุงูุจูุฑุฉ โ ุงููุงุณ (ุชุฑุชูุจู)
              </small>
            </div>
          </div>

          <div id="assessmentFieldsContainer">
          <!-- Asr Prayer Score -->
          <div class="form-group">
            <label>๐ ุตูุงุฉ ุงูุนุตุฑ</label>
            <div class="score-input-container">
              <button class="score-btn" onclick="changeScore('asrPrayer', -1)">-</button>
              <div class="score-display" id="asrPrayerDisplay">5</div>
              <button class="score-btn" onclick="changeScore('asrPrayer', 1)">+</button>
            </div>
          </div>

          <!-- Lesson Score -->
          <div class="form-group">
            <label>๐ ุงูุฏุฑุณ</label>
            <div class="score-input-container">
              <button class="score-btn" onclick="changeScore('lesson', -1)">-</button>
              <div class="score-display" id="lessonDisplay">5</div>
              <button class="score-btn" onclick="changeScore('lesson', 1)">+</button>
            </div>
            
            <label style="margin-top: 15px;">ูู:</label>
            <div class="surah-input-container">
              <select id="lessonSurahFrom" class="text-input" onchange="updateVerseOptions('lessonSurahFrom', 'lessonVerseFrom'); saveStudentFormData()">
                <option value="">-- ุงุฎุชุฑ ุงูุณูุฑุฉ --</option>
              </select>
              <select id="lessonVerseFrom" class="text-input" onchange="saveStudentFormData()">
                <option value="">-- ุฑูู ุงูุขูุฉ --</option>
              </select>
            </div>
            
            <label style="margin-top: 10px;">ุฅูู:</label>
            <div class="surah-input-container">
              <select id="lessonSurahTo" class="text-input" onchange="updateVerseOptions('lessonSurahTo', 'lessonVerseTo'); saveStudentFormData()">
                <option value="">-- ุงุฎุชุฑ ุงูุณูุฑุฉ --</option>
              </select>
              <select id="lessonVerseTo" class="text-input" onchange="saveStudentFormData()">
                <option value="">-- ุฑูู ุงูุขูุฉ --</option>
              </select>
            </div>
          </div>

          <!-- Lesson Side Score -->
          <div class="form-group">
            <label>๐ ุฌูุจ ุงูุฏุฑุณ</label>
            <div class="score-input-container">
              <button class="score-btn" onclick="changeScore('lessonSide', -1)">-</button>
              <div class="score-display" id="lessonSideDisplay">5</div>
              <button class="score-btn" onclick="changeScore('lessonSide', 1)">+</button>
            </div>
            <input type="text" id="teacherLessonSideText" class="text-input" placeholder="ูุต ุฌูุจ ุงูุฏุฑุณ" onchange="saveStudentFormData()">
          </div>

          <!-- Revision Score -->
          <div class="form-group">
            <label>๐ ุงููุฑุงุฌุนุฉ</label>
            <div class="score-input-container">
              <button class="score-btn" onclick="changeScore('revision', -1)">-</button>
              <div class="score-display" id="revisionDisplay">5</div>
              <button class="score-btn" onclick="changeScore('revision', 1)">+</button>
            </div>
            
            <label style="margin-top: 15px;">ูู:</label>
            <div class="surah-input-container">
              <select id="revisionSurahFrom" class="text-input" onchange="updateVerseOptions('revisionSurahFrom', 'revisionVerseFrom'); saveStudentFormData()">
                <option value="">-- ุงุฎุชุฑ ุงูุณูุฑุฉ --</option>
              </select>
              <select id="revisionVerseFrom" class="text-input" onchange="saveStudentFormData()">
                <option value="">-- ุฑูู ุงูุขูุฉ --</option>
              </select>
            </div>
            
            <label style="margin-top: 10px;">ุฅูู:</label>
            <div class="surah-input-container">
              <select id="revisionSurahTo" class="text-input" onchange="updateVerseOptions('revisionSurahTo', 'revisionVerseTo'); saveStudentFormData()">
                <option value="">-- ุงุฎุชุฑ ุงูุณูุฑุฉ --</option>
              </select>
              <select id="revisionVerseTo" class="text-input" onchange="saveStudentFormData()">
                <option value="">-- ุฑูู ุงูุขูุฉ --</option>
              </select>
            </div>
          </div>

          <!-- Reading Score -->
          <div class="form-group">
            <label>๐๏ธ ุงููุฑุงุกุฉ ุจุงููุธุฑ</label>
            <div class="score-input-container">
              <button class="score-btn" onclick="changeScore('reading', -1)">-</button>
              <div class="score-display" id="readingDisplay">5</div>
              <button class="score-btn" onclick="changeScore('reading', 1)">+</button>
            </div>
          </div>

          <!-- Behavior Score -->
          <div class="form-group">
            <label>โญ ุงูุณููู</label>
            <div class="score-input-container">
              <button class="score-btn" onclick="changeScore('behavior', -1)">-</button>
              <div class="score-display" id="behaviorDisplay">5</div>
              <button class="score-btn" onclick="changeScore('behavior', 1)">+</button>
            </div>
          </div>

          <!-- Extra Lessons (Optional) -->
          <div class="form-group" style="background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%); padding: 15px; border-radius: 10px; margin-top: 20px;">
            <label style="color: white; font-weight: bold; display: flex; align-items: center; gap: 8px; margin-bottom: 10px;">
              โญ ุฏุฑูุณ ุฅุถุงููุฉ (ุงุฎุชูุงุฑู)
              <span style="font-size: 11px; font-weight: normal; background: rgba(0,0,0,0.2); padding: 4px 8px; border-radius: 4px;">
                ๐ก ุฅุฐุง ุณููุน ุฏุฑุณูู ูู ููุณ ุงูููู
              </span>
            </label>
            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px; align-items: center;">
              <input type="number" id="teacherExtraLessons" min="0" max="5" value="0" placeholder="0" 
                style="padding: 10px; border: 2px solid rgba(255,255,255,0.3); border-radius: 8px; font-size: 16px; text-align: center; background: rgba(255,255,255,0.9);">
              <small style="color: white; font-size: 12px; background: rgba(0,0,0,0.2); padding: 8px; border-radius: 6px;">
                ุณููุญุชุณุจ ุชููุงุฆูุงู ูู ุงูุชูุงุฑูุฑ (ูุซุงู: 1 = ุฏุฑุณููุ 2 = ุซูุงุซุฉ ุฏุฑูุณ)
              </small>
            </div>
          </div>

          <!-- Struggle Indicator -->
          <div id="struggleIndicator" class="struggle-indicator struggle-no">
            โ ุงูุทุงูุจ ุบูุฑ ูุชุนุซุฑ - ุฃุฏุงุก ููุชุงุฒ
          </div>

          </div><!-- End assessmentFieldsContainer -->
          
          <!-- Save button outside container so it shows even when absent -->
          <button onclick="saveTeacherAssessment()" class="save-assessment-btn">
            ๐พ ุญูุธ ุงูุชูููู
          </button>
          <div id="teacherStatus" class="small" style="margin-top: 10px; text-align: center; font-size: 16px;"></div>
        </div>

        <!-- Dabt Assessment Form (ุถุจุท) -->
        <div id="dabtAssessmentForm" class="assessment-form" style="display:none; margin-top: 30px;">
          <div style="background: linear-gradient(135deg, #f5576c 0%, #e43a15 100%); padding: 20px; border-radius: 12px; color: white; text-align: center; margin-bottom: 20px;">
            <h3 style="margin: 0; font-size: 24px;">โจ ูููุฐุฌ ุชูููู ุงูุถุจุท</h3>
            <p style="margin: 10px 0 0 0; opacity: 0.9;">ููุฏ ุงูุชุทููุฑ - ุณูุชู ุฅุถุงูุชู ูุฑูุจุงู</p>
          </div>
        </div>

        <!-- Noorani Assessment Form (ุงููุงุนุฏุฉ ุงูููุฑุงููุฉ) -->
        <div id="nooraniAssessmentForm" class="assessment-form" style="display:none; margin-top: 30px;">
          <div style="background: linear-gradient(135deg, #feca57 0%, #ff9ff3 100%); padding: 20px; border-radius: 12px; color: white; text-align: center; margin-bottom: 20px;">
            <h3 style="margin: 0; font-size: 24px;">๐ ูููุฐุฌ ุชูููู ุงููุงุนุฏุฉ ุงูููุฑุงููุฉ</h3>
            <p style="margin: 10px 0 0 0; opacity: 0.9;">ููุฏ ุงูุชุทููุฑ - ุณูุชู ุฅุถุงูุชู ูุฑูุจุงู</p>
          </div>
        </div>

        <!-- Past Reports -->
        <div id="pastReportsSection" style="display:none; margin-top: 30px;">
          <h3>ุงูุชููููุงุช ุงูุณุงุจูุฉ</h3>
          <div id="pastReportsContainer"></div>
        </div>

        <!-- Struggles Section -->
        <div id="strugglesSection" style="display:none; margin-top: 30px;">
          <h3>ุงูุชุนุซุฑุงุช (ุงูุฏุฑุฌุงุช ุบูุฑ ุงููุงููุฉ)</h3>
          <div id="strugglesContainer"></div>
        </div>

        <!-- Monthly Exam Section -->
        <div id="monthlyExamSection" style="display:none; margin-top: 30px;">
          <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 15px; color: white; margin-bottom: 20px;">
            <h3 style="margin: 0 0 10px 0; text-align: center;">๐ ุงูุงุฎุชุจุงุฑ ุงูุดูุฑู ุงูุฅููุชุฑููู</h3>
            <p style="margin: 0; text-align: center; font-size: 14px; opacity: 0.9;">ุงุฎุชุจุงุฑ ุชูุงูุฉ ุงููุฑุขู ุงููุฑูู</p>
          </div>

          <!-- Exam Form -->
          <div id="examForm" style="background: #f8f9fa; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            
            <!-- Student and Teacher Info -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
              <div>
                <label style="display: block; margin-bottom: 5px; color: #666; font-size: 13px;">ุงุณู ุงูุทุงูุจ</label>
                <input type="text" id="examStudentName" readonly style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; background: #fff;" />
              </div>
              <div>
                <label style="display: block; margin-bottom: 5px; color: #666; font-size: 13px;">ุงุณู ุงููุนูู</label>
                <input type="text" id="examTeacherName" readonly style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; background: #fff;" />
              </div>
              <div>
                <label style="display: block; margin-bottom: 5px; color: #666; font-size: 13px;">ุงูุชุงุฑูุฎ ุงููุฌุฑู</label>
                <input type="text" id="examDate" readonly style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; background: #fff;" />
              </div>
            </div>

            <!-- Exam Settings -->
            <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 2px solid #667eea;">
              <h4 style="margin: 0 0 15px 0; color: #667eea;">ุฅุนุฏุงุฏุงุช ุงูุงุฎุชุจุงุฑ</h4>
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                <div>
                  <label style="display: block; margin-bottom: 5px; color: #666; font-size: 13px;">ุนุฏุฏ ุงูุฃุณุฆูุฉ</label>
                  <input type="number" id="examQuestionsCount" value="6" min="3" max="20" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px;" />
                </div>
                <div>
                  <label style="display: block; margin-bottom: 5px; color: #666; font-size: 13px;">ุงูุฏุฑุฌุฉ ุงููุตูู</label>
                  <input type="number" id="examMaxScore" value="100" min="50" max="200" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px;" />
                </div>
                <div>
                  <label style="display: block; margin-bottom: 5px; color: #666; font-size: 13px;">ูุณุจุฉ ุงููุฌุงุญ (%)</label>
                  <input type="number" id="examPassPercent" value="97" min="50" max="100" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px;" />
                </div>
              </div>
              <button onclick="generateExamQuestions()" style="margin-top: 15px; background: #667eea; color: white; padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; width: 100%;">
                ๐ ุฅูุดุงุก ุฃุณุฆูุฉ ุงูุงุฎุชุจุงุฑ
              </button>
            </div>

            <!-- Weights Settings -->
            <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 2px solid #764ba2;">
              <h4 style="margin: 0 0 15px 0; color: #764ba2;">ุฃูุฒุงู ุฎุตู ุงูููุงุท</h4>
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px;">
                <div>
                  <label style="display: block; margin-bottom: 5px; color: #666; font-size: 12px;">ุชูุจูู</label>
                  <input type="number" id="examWeightTanbih" value="0.5" step="0.1" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 6px;" />
                </div>
                <div>
                  <label style="display: block; margin-bottom: 5px; color: #666; font-size: 12px;">ุฎุทุฃ</label>
                  <input type="number" id="examWeightKhata" value="1" step="0.1" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 6px;" />
                </div>
                <div>
                  <label style="display: block; margin-bottom: 5px; color: #666; font-size: 12px;">ุชุฌููุฏ</label>
                  <input type="number" id="examWeightTajweed" value="2" step="0.1" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 6px;" />
                </div>
                <div>
                  <label style="display: block; margin-bottom: 5px; color: #666; font-size: 12px;">ูุญู ุฌูู</label>
                  <input type="number" id="examWeightLahn" value="3" step="0.1" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 6px;" />
                </div>
              </div>
            </div>

            <!-- Questions Table -->
            <div id="examQuestionsContainer" style="display: none;">
              <div style="overflow-x: auto; margin-bottom: 20px;">
                <table style="width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden;">
                  <thead>
                    <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                      <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ุฑูู</th>
                      <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ุงูุณูุฑุฉ</th>
                      <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ุงูููุถุน</th>
                      <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ุชูุจูู</th>
                      <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ุฎุทุฃ</th>
                      <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ุชุฌููุฏ</th>
                      <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ูุญู ุฌูู</th>
                      <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ููุงุญุธุงุช</th>
                      <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ููุงุท ูุฎุตููุฉ</th>
                    </tr>
                  </thead>
                  <tbody id="examQuestionsTableBody">
                  </tbody>
                </table>
              </div>

              <!-- Summary -->
              <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <h4 style="margin: 0 0 15px 0; color: #333; text-align: center;">ููุฎุต ุงููุชุงุฆุฌ</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 15px;">
                  <div style="text-align: center; padding: 10px; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-size: 12px; color: #666; margin-bottom: 5px;">ุฅุฌูุงูู ุงูุชูุจููุงุช</div>
                    <div id="examSumTanbih" style="font-size: 20px; font-weight: bold; color: #ffc107;">0</div>
                  </div>
                  <div style="text-align: center; padding: 10px; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-size: 12px; color: #666; margin-bottom: 5px;">ุฅุฌูุงูู ุงูุฃุฎุทุงุก</div>
                    <div id="examSumKhata" style="font-size: 20px; font-weight: bold; color: #ff9800;">0</div>
                  </div>
                  <div style="text-align: center; padding: 10px; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-size: 12px; color: #666; margin-bottom: 5px;">ุฅุฌูุงูู ุงูุชุฌููุฏ</div>
                    <div id="examSumTajweed" style="font-size: 20px; font-weight: bold; color: #ff5722;">0</div>
                  </div>
                  <div style="text-align: center; padding: 10px; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-size: 12px; color: #666; margin-bottom: 5px;">ุฅุฌูุงูู ุงููุญู ุงูุฌูู</div>
                    <div id="examSumLahn" style="font-size: 20px; font-weight: bold; color: #f44336;">0</div>
                  </div>
                  <div style="text-align: center; padding: 10px; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-size: 12px; color: #666; margin-bottom: 5px;">ูุฌููุน ุงูููุงุท ุงููุฎุตููุฉ</div>
                    <div id="examSumPoints" style="font-size: 20px; font-weight: bold; color: #9c27b0;">0</div>
                  </div>
                </div>
                
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; text-align: center;">
                  <div style="font-size: 16px; margin-bottom: 10px; opacity: 0.9;">ุงูุฏุฑุฌุฉ ุงูููุงุฆูุฉ</div>
                  <div style="font-size: 36px; font-weight: bold;"><span id="examFinalScore">0</span> / <span id="examMaxScoreDisplay">100</span></div>
                  <div id="examResultBadge" style="margin-top: 15px; padding: 12px; border-radius: 10px; font-size: 18px; font-weight: bold; display: none;"></div>
                </div>
              </div>

              <!-- Action Buttons -->
              <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                <button onclick="calculateExamResults()" style="background: #28a745; color: white; padding: 12px 30px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">
                  ๐งฎ ุญุณุงุจ ุงููุชุงุฆุฌ
                </button>
                <button onclick="saveExamResults()" style="background: #667eea; color: white; padding: 12px 30px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">
                  ๐พ ุญูุธ ุฏุฑุฌุฉ ุงูุงุฎุชุจุงุฑ
                </button>
                <button id="sendExamToAdminBtn" onclick="sendExamScoreToAdmin()" style="display: none; background: #ff6b6b; color: white; padding: 12px 30px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">
                  ๐ค ุฅุฑุณุงู ููุฅุฏุงุฑุฉ
                </button>
                <button onclick="resetExam()" style="background: #dc3545; color: white; padding: 12px 30px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">
                  ๐ ุฅุนุงุฏุฉ ุชุนููู
                </button>
              </div>
              
              <div id="examSaveStatus" style="margin-top: 15px; text-align: center; font-size: 16px; font-weight: bold;"></div>
            </div>
          </div>
        </div>
        
        </div><!-- End main-content-area -->
      </div>
    </div>
  </div>
  </div><!-- End teacherSection -->

  <!-- Student Section -->
  <div id="studentSection" style="display:none;">
    <!-- Student Login -->
    <div id="studentLogin" class="login-container">
      <div style="text-align: center; margin-bottom: 30px;">
        <div style="font-size: 60px; margin-bottom: 10px;">๐จโ๐</div>
        <h2 style="margin: 0; color: #667eea;">ุชุณุฌูู ุฏุฎูู ุงูุทุงูุจ</h2>
        <p style="color: #666; font-size: 14px; margin-top: 5px;">ุงุฎุชุฑ ูุนููู ุซู ุณุฌู ุฏุฎููู</p>
      </div>

      <div class="login-form-group">
        <label>๐จโ๐ซ ุงุฎุชุฑ ุงููุนูู</label>
        <select id="studentTeacherSelect" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; background: white; cursor: pointer;">
          <option value="">-- ุงุฎุชุฑ ุงููุนูู --</option>
        </select>
      </div>

      <div class="login-form-group">
        <label>๐ค ุงุฎุชุฑ ุงุณูู</label>
        <select id="studentNameSelect" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; background: white; cursor: pointer;" disabled>
          <option value="">-- ุงุฎุชุฑ ุงููุนูู ุฃููุงู --</option>
        </select>
      </div>
      
      <div class="login-form-group">
        <label>๐ ุงูุฑูู ุงูุณุฑู</label>
        <input type="password" id="studentPasswordInput" placeholder="ุฃุฏุฎู ุงูุฑูู ุงูุณุฑู (s12345)" style="padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;">
      </div>
      
      <button class="login-btn" onclick="window.loginStudent()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); width: 100%; padding: 15px; font-size: 18px; font-weight: bold; border: none; border-radius: 8px; color: white; cursor: pointer; margin-top: 10px;">
        ุฏุฎูู ๐
      </button>
      <div id="studentLoginError" class="login-error"></div>
      <button class="back-btn" onclick="window.showRoleSelection()" style="width: 100%; padding: 12px; margin-top: 15px; background: #f5f5f5; border: 2px solid #ddd; border-radius: 8px; cursor: pointer; font-size: 16px;">
        โ ุฑุฌูุน
      </button>
    </div>

    <!-- Student Dashboard (hidden until login) -->
    <div id="studentDashboard" style="display:none;">
      <div class="admin-header" style="display: flex; align-items: center; justify-content: space-between; padding: 20px 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <div style="display: flex; align-items: center; gap: 20px;">
          <div style="font-size: 40px;">๐จโ๐</div>
          <div>
            <h2 style="margin: 0; font-size: 24px;" id="studentNameDisplay">ุงูุทุงูุจ</h2>
            <div class="date-time-display" id="studentDateTime" style="font-size: 14px; opacity: 0.9; margin-top: 5px;"></div>
          </div>
        </div>
        <div style="display: flex; gap: 15px; align-items: center;">
          <!-- Inbox Notifications -->
          <div style="position: relative;">
            <button onclick="window.toggleStudentInbox()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3); color: white; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 16px; display: flex; align-items: center; gap: 8px;">
              ๐ฌ ุงูุฅุดุนุงุฑุงุช
              <span id="studentInboxBadge" style="display: none; background: #ff4757; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px; font-weight: bold;"></span>
            </button>
          </div>
          <!-- Attendance Report -->
          <button onclick="window.showStudentAttendance()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3); color: white; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 16px;">
            ๐ ุงูุญุถูุฑ
          </button>
          <button class="logout-btn" onclick="window.logout()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3); padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 16px;">
            ุชุณุฌูู ุงูุฎุฑูุฌ
          </button>
        </div>
      </div>

      <!-- Inbox Panel -->
      <div id="studentInboxPanel" style="display: none; position: fixed; top: 80px; right: 30px; width: 400px; max-height: 500px; background: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); z-index: 1000; overflow: hidden;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 15px 20px; color: white; display: flex; justify-content: space-between; align-items: center;">
          <h3 style="margin: 0; font-size: 18px;">๐ฌ ุงูุฅุดุนุงุฑุงุช</h3>
          <button onclick="window.toggleStudentInbox()" style="background: none; border: none; color: white; font-size: 24px; cursor: pointer; padding: 0; line-height: 1;">ร</button>
        </div>
        <div id="studentInboxMessages" style="max-height: 400px; overflow-y: auto; padding: 15px;"></div>
      </div>

      <!-- Attendance Panel -->
      <div id="studentAttendancePanel" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 500px; background: white; border-radius: 15px; box-shadow: 0 4px 30px rgba(0,0,0,0.3); z-index: 1000; overflow: hidden;">
        <div style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); padding: 20px; color: white;">
          <h3 style="margin: 0; font-size: 20px;">๐ ุชูุฑูุฑ ุงูุญุถูุฑ ูุงูุบูุงุจ</h3>
          <p style="margin: 5px 0 0 0; font-size: 14px; opacity: 0.9;" id="studentAttendanceMonth"></p>
        </div>
        <div style="padding: 25px;">
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
            <div style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); padding: 20px; border-radius: 10px; text-align: center; color: white;">
              <div style="font-size: 14px; margin-bottom: 5px;">โ ุฃูุงู ุงูุญุถูุฑ</div>
              <div id="studentPresentCount" style="font-size: 36px; font-weight: bold;">0</div>
            </div>
            <div style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); padding: 20px; border-radius: 10px; text-align: center; color: white;">
              <div style="font-size: 14px; margin-bottom: 5px;">โ ุฃูุงู ุงูุบูุงุจ</div>
              <div id="studentAbsentCount" style="font-size: 36px; font-weight: bold;">0</div>
            </div>
          </div>
          <button onclick="window.hideStudentAttendance()" style="width: 100%; padding: 12px; background: #f5f5f5; border: 2px solid #ddd; border-radius: 8px; cursor: pointer; font-size: 16px;">
            ุฅุบูุงู
          </button>
        </div>
      </div>

      <!-- Main Content -->
      <div style="padding: 30px; max-width: 1200px; margin: 0 auto;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 15px; color: white; margin-bottom: 30px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
          <h2 style="margin: 0 0 10px 0; font-size: 28px;">๐ ุชููููุงุชู</h2>
          <p style="margin: 0; font-size: 16px; opacity: 0.9;">ุฌููุน ุชููููุงุชู ูู ุงููุนูู</p>
        </div>

        <!-- Assessments List -->
        <div id="studentAssessmentsList" style="display: grid; gap: 20px;">
          <div style="text-align: center; padding: 60px; color: #999;">
            <div style="font-size: 60px; margin-bottom: 15px;">๐</div>
            <p style="font-size: 18px;">ุฌุงุฑู ุชุญููู ุงูุชููููุงุช...</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Viewer Section -->
  <div id="viewerSection" style="display:none;">
    <!-- Viewer Login -->
    <div id="viewerLogin" class="login-container">
      <h2>ุชุณุฌูู ุฏุฎูู ุนุงุฑุถ ุงูุฃุฌุฒุงุก</h2>
      <div class="login-form-group">
        <label>ูุนุฑูู ุงูุนุงุฑุถ</label>
        <input type="text" id="viewerIdInput" value="MZNBL01" readonly style="background: #f5f5f5;">
      </div>
      
      <div class="login-form-group">
        <label>ุงูุฑูู ุงูุณุฑู (Password)</label>
        <input type="password" id="viewerPasswordInput" placeholder="ุฃุฏุฎู ุงูุฑูู ุงูุณุฑู">
      </div>
      
      <button class="login-btn" onclick="window.loginViewer()">ุฏุฎูู</button>
      <div id="viewerLoginError" class="login-error"></div>
      <button class="back-btn" onclick="window.showRoleSelection()">ุฑุฌูุน</button>
    </div>

    <!-- Viewer Dashboard (hidden until login) -->
    <div id="viewerDashboard" style="display:none;">
      <div class="admin-header">
        <h2>๐ ููุญุฉ ุนุงุฑุถ ุงูุฃุฌุฒุงุก</h2>
        <div class="date-time-display" id="viewerDateTime"></div>
        <button class="logout-btn" onclick="window.logout()">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
      </div>

      <div style="padding: 20px;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 15px; color: white; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); position: relative;">
          <!-- Inbox Button for Viewer -->
          <button id="viewerInboxBtn" onclick="window.toggleViewerInbox()" style="position: absolute; left: 20px; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.25); color: white; padding: 10px 20px; font-size: 14px; border: 2px solid rgba(255,255,255,0.5); border-radius: 8px; cursor: pointer; transition: all 0.3s; font-weight: bold;">
            ๐ฌ ุตูุฏูู ุงูุฅุดุนุงุฑุงุช
            <span id="viewerInboxBadge" style="display: none; position: absolute; top: -8px; right: -8px; background: #dc3545; color: white; border-radius: 50%; width: 24px; height: 24px; font-size: 12px; font-weight: bold; align-items: center; justify-content: center; box-shadow: 0 2px 5px rgba(220,53,69,0.5); animation: pulse 1.5s infinite;">0</span>
          </button>
          
          <h2 style="margin: 0 0 10px 0; font-size: 28px; text-align: center;">๐ ุนุฑุถ ุงูุฃุฌุฒุงุก ุงููุฑุขููุฉ</h2>
          <p style="margin: 0; font-size: 16px; opacity: 0.9; text-align: center;">ูุฑุญุจุงู ุจู - ูุงุฒู ุงูุจููุดู</p>
        </div>
        
        <!-- Viewer Inbox Modal -->
        <div id="viewerInboxModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
          <div style="background: white; width: 90%; max-width: 700px; max-height: 80vh; border-radius: 15px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; display: flex; justify-content: space-between; align-items: center;">
              <h3 style="margin: 0; font-size: 22px;">๐ฌ ุตูุฏูู ุงูุฅุดุนุงุฑุงุช</h3>
              <button onclick="window.toggleViewerInbox()" style="background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; cursor: pointer; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">ร</button>
            </div>
            <div id="viewerInboxNotificationsList" style="padding: 20px; max-height: 60vh; overflow-y: auto;">
              <p style="text-align: center; color: #999; padding: 40px;">ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช ุฌุฏูุฏุฉ</p>
            </div>
          </div>
        </div>

        <!-- Tabs Navigation -->
        <div style="display: flex; gap: 10px; margin-bottom: 20px;">
          <button id="tabNewJuz" onclick="window.showViewerTab('newJuz')" style="flex: 1; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 10px; font-size: 16px; font-weight: bold; cursor: pointer; box-shadow: 0 3px 10px rgba(0,0,0,0.2);">
            โ ุชุณุฌูู ุทุงูุจ ุฌุฏูุฏ ููุนุฑุถ
          </button>
          <button id="tabReports" onclick="window.showViewerTab('reports')" style="flex: 1; padding: 15px; background: white; color: #667eea; border: 2px solid #667eea; border-radius: 10px; font-size: 16px; font-weight: bold; cursor: pointer;">
            ๐ ุชูุงุฑูุฑ ุฃุฌุฒุงุก ุงูุทูุงุจ
          </button>
        </div>

        <!-- Tab 1: Register New Student for Juz Display -->
        <div id="viewerTabNewJuz" style="display: block;">
          <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h3 style="margin: 0 0 20px 0; color: #667eea; border-bottom: 2px solid #667eea; padding-bottom: 10px;">โ ุชุณุฌูู ุทุงูุจ ุฌุฏูุฏ ููุนุฑุถ</h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
              <div>
                <label style="display: block; margin-bottom: 8px; color: #333; font-weight: bold;">ุงุณู ุงููุนูู</label>
                <select id="viewerTeacherSelect" onchange="window.loadStudentsByTeacher()" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                  <option value="">-- ุงุฎุชุฑ ุงููุนูู --</option>
                </select>
              </div>
              
              <div>
                <label style="display: block; margin-bottom: 8px; color: #333; font-weight: bold;">ุงุณู ุงูุทุงูุจ</label>
                <select id="viewerStudentSelect" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                  <option value="">-- ุงุฎุชุฑ ุงููุนูู ุฃููุงู --</option>
                </select>
              </div>
              
              <div>
                <label style="display: block; margin-bottom: 8px; color: #333; font-weight: bold;">ุฑูู ุงูุฌุฒุก</label>
                <select id="viewerJuzNumber" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                  <option value="">-- ุงุฎุชุฑ ุงูุฌุฒุก --</option>
                </select>
              </div>
              
              <div>
                <label style="display: block; margin-bottom: 8px; color: #333; font-weight: bold;">ุชุงุฑูุฎ ุขุฎุฑ ุฏุฑุณ ุนูุฏ ุงููุนูู (ูุฌุฑู)</label>
                <div style="display: flex; gap: 5px;">
                  <input type="text" id="viewerLastLessonDate" placeholder="DD-MM-YYYY" style="flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; text-align: center;">
                  <button onclick="document.getElementById('viewerLastLessonDate').value = window.getTodayHijriSimple()" 
                    style="padding: 12px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; white-space: nowrap;">
                    ๐ ุงูููู
                  </button>
                </div>
                <small style="color: #666; font-size: 12px;">ูุซุงู: 5-6-1447 (ุงูููู-ุงูุดูุฑ-ุงูุณูุฉ)</small>
              </div>
              
              <div>
                <label style="display: block; margin-bottom: 8px; color: #333; font-weight: bold;">ุชุงุฑูุฎ ุงูุนุฑุถ ุนูุฏ ุงูุนุงุฑุถ (ูุฌุฑู) - ุงุฎุชูุงุฑู</label>
                <div style="display: flex; gap: 5px;">
                  <input type="text" id="viewerDisplayDate" placeholder="DD-MM-YYYY" style="flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; text-align: center;">
                  <button onclick="document.getElementById('viewerDisplayDate').value = window.getTodayHijriSimple()" 
                    style="padding: 12px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; white-space: nowrap;">
                    ๐ ุงูููู
                  </button>
                  <button onclick="window.openHijriCalendar('viewerDisplayDate')" 
                    style="padding: 12px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; white-space: nowrap;">
                    ๐ ุชูููู
                  </button>
                </div>
                <small style="color: #666; font-size: 12px;">ุณูุชู ุฅุถุงูุชู ูุงุญูุงู ุจุนุฏ ุงูุนุฑุถ</small>
              </div>
              
              <div>
                <label style="display: block; margin-bottom: 8px; color: #333; font-weight: bold;">ุงุณู ุงูุนุงุฑุถ</label>
                <input type="text" id="viewerName" value="ูุงุฒู ุงูุจููุดู" readonly style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; background: #f5f5f5;">
              </div>
            </div>
            
            <div style="margin-top: 20px;">
              <button onclick="window.saveNewJuzDisplay()" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; border: none; border-radius: 10px; font-size: 18px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(40,167,69,0.3);">
                ๐พ ุญูุธ ุงูุชุณุฌูู
              </button>
            </div>
            
            <div id="viewerNewJuzMessage" style="margin-top: 15px; padding: 12px; border-radius: 8px; display: none;"></div>
          </div>
        </div>

        <!-- Tab 2: Juz Reports -->
        <div id="viewerTabReports" style="display: none;">
          <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h3 style="margin: 0 0 20px 0; color: #667eea; border-bottom: 2px solid #667eea; padding-bottom: 10px;">๐ ุชูุงุฑูุฑ ุฃุฌุฒุงุก ุงูุทูุงุจ</h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
              <div>
                <label style="display: block; margin-bottom: 8px; color: #333; font-weight: bold;">ุงุฎุชุฑ ุงููุนูู</label>
                <select id="viewerReportTeacherSelect" onchange="window.loadViewerStudentsByTeacher()" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                  <option value="">-- ุงุฎุชุฑ ุงููุนูู --</option>
                </select>
              </div>
              
              <div>
                <label style="display: block; margin-bottom: 8px; color: #333; font-weight: bold;">ุงุฎุชุฑ ุงูุทุงูุจ</label>
                <select id="viewerReportStudentSelect" onchange="window.loadViewerJuzReports()" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                  <option value="">-- ุงุฎุชุฑ ุงูุทุงูุจ --</option>
                </select>
              </div>
            </div>
            
            <div id="viewerReportsContainer" style="margin-top: 20px;">
              <p style="text-align: center; color: #999; padding: 40px;">ุงุฎุชุฑ ุงููุนูู ูุงูุทุงูุจ ูุนุฑุถ ุงูุชูุงุฑูุฑ</p>
            </div>
          </div>
        </div>

        <!-- Hijri Calendar Modal (Viewer Only) -->
        <div id="hijriCalendarModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; justify-content: center; align-items: center;">
          <div class="modal-content" style="max-width: 450px; padding: 0; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; text-align: center;">
              <h3 style="margin: 0; font-size: 20px; font-weight: bold;">๐ ุงูุชูููู ุงููุฌุฑู</h3>
            </div>
            
            <div style="padding: 20px;">
              <!-- Month/Year Navigation -->
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <button onclick="window.changeHijriMonth(-1)" style="padding: 8px 15px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 18px;">โ</button>
                <div style="text-align: center;">
                  <div id="hijriMonthYear" style="font-size: 18px; font-weight: bold; color: #333;"></div>
                </div>
                <button onclick="window.changeHijriMonth(1)" style="padding: 8px 15px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 18px;">โถ</button>
              </div>
              
              <!-- Calendar Grid -->
              <div id="hijriCalendarGrid" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; margin-bottom: 20px;"></div>
              
              <!-- Action Buttons -->
              <div style="display: flex; gap: 10px;">
                <button onclick="window.selectTodayHijri()" style="flex: 1; padding: 12px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">ุงูููู</button>
                <button onclick="document.getElementById('hijriCalendarModal').style.display = 'none'" style="flex: 1; padding: 12px; background: #dc3545; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">ุฅูุบุงุก</button>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script type="module" src="app.js"></script>
  <script type="module" src="js/mobile-ui.js"></script>
</body>
</html>
